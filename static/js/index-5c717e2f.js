import{_ as k,g as j,d as E}from"./NewsForm.vue_vue_type_script_setup_true_lang-7e3798f2.js";import{d as H}from"./dayjs.min-a39f8444.js";import{x as z,r as c,e as I,o as O,a7 as d,y as L,z as P,A as v,P as e,I as a,M as i,O as $,u as b}from"./runtime-core.esm-bundler-5e6ff93b.js";import"./index-abf2ad1d.js";import"./vue-router-6a953c55.js";const q={class:"bg-white border-gray-200 p-5 flex"},G={class:"ml-10"},J=v("p",null,"确认删除该数据",-1),ee=z({__name:"index",setup(K){z(k);const r=c(null),g=c([]),f=c([]),w=c(0),_=c(5),p=c(1),y=c(0),h={"-1":{type:"warning",label:"已下架"},0:{type:"warning",label:"已下架"},1:{type:"warning",label:"已下架"}},D=I(()=>f.value.slice((p.value-1)*_.value,_.value*p.value));O(async()=>{await m({u_id:1})});const C=async()=>{await m({u_id:1})},m=async t=>{const s=await j(t);f.value=s.data.news,w.value=f.value.length},N=t=>{p.value=t,m({u_id:1})},B=t=>{_.value=t,m({u_id:1})},x=(t,s,n,o)=>H(n).format("YYYY-MM-DD HH:mm:ss"),F=(t,s)=>{r.value.visible=!0,r.value.title="编辑新闻",y.value=s.content_id,r.value.newsForm=Object.assign(r.value.newsForm,s)},M=()=>{r.value.visible=!0,r.value.title="新增新闻"},S=async(t,s)=>{const{t_id:n}=s;await E({t_id:n,u_id:1}),b(g)[t].hide(),await m({u_id:1})},Y=t=>{b(g)[t].hide()};return(t,s)=>{const n=d("el-button"),o=d("el-table-column"),A=d("el-tag"),R=d("el-popover"),T=d("el-table"),V=d("el-pagination");return L(),P("div",null,[v("div",q,[v("div",null,[e(n,{type:"primary",onClick:M},{default:a(()=>[i("新增")]),_:1})]),v("div",G,[e(n,{type:"success",onClick:C},{default:a(()=>[i("搜索")]),_:1})])]),e(T,{data:b(D),border:""},{default:a(()=>[e(o,{prop:"t_id",label:"id"}),e(o,{prop:"title",label:"标题"},{default:a(({row:l,$index:u})=>[i($(`${l.title} | ${u+_.value*(p.value-1)+1}`),1)]),_:1}),e(o,{prop:"type",label:"文章类型"}),e(o,{prop:"tag",label:"文章标签"}),e(o,{prop:"u_id",label:"作者"}),e(o,{prop:"create_time",label:"创建时间",formatter:x}),e(o,{prop:"publish_time",label:"发布时间",formatter:x}),e(o,{prop:"status",label:"状态"},{default:a(l=>[e(A,{type:h[l.row.status].type},{default:a(()=>[i($(h[l.row.status].label),1)]),_:2},1032,["type"])]),_:1}),e(o,{label:"操作",align:"center"},{default:a(l=>[e(n,{size:"small",onClick:u=>F(l.$index,l.row)},{default:a(()=>[i("编辑")]),_:2},1032,["onClick"]),e(R,{placement:"top",width:260,ref:u=>{g.value[l.$index]=u},trigger:"click"},{reference:a(()=>[e(n,{type:"danger",size:"small"},{default:a(()=>[i("删除")]),_:1})]),default:a(()=>[J,v("div",null,[e(n,{size:"small",type:"primary",onClick:u=>Y(l.$index)},{default:a(()=>[i("取消")]),_:2},1032,["onClick"]),e(n,{size:"small",text:"",onClick:u=>S(l.$index,l.row)},{default:a(()=>[i("确认")]),_:2},1032,["onClick"])])]),_:2},1536)]),_:1})]),_:1},8,["data"]),e(V,{small:"",background:"",layout:"prev, pager, next, total, sizes",total:w.value,"current-page":p.value,"page-size":_.value,"page-sizes":[5,10,50],class:"mt-4 float-right",onSizeChange:B,onCurrentChange:N},null,8,["total","current-page","page-size"]),e(k,{ref_key:"newsFormRef",ref:r,content_id:y.value,onInit:C},null,8,["content_id"])])}}});export{ee as default};
